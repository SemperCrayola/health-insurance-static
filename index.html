<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Insurance Calculator</title>
</head>
<body>
    <h1>Health Insurance Calculator</h1>
    <p>This program helps you classify health insurance based on their risk level. <br>
        Their health is judged in terms of their body-mass index, blood pressure, age,<br>
        and family history of disease.</p>
    <div>
        <label for="age">Age: </label>
        <input type="number" id="age">
    </div>
    <div>
        <label for="height">Height in Inches:</label>
        <input type="number" id="height">
    </div>
    <div>
        <label for="weight">Weight in Pounds:</label>
        <input type="number" id="weight">
    </div>
    <div>
        <label for="systolic">Systolic Blood Pressure:</label>
        <input type="number" id="systolic">
    </div>
    <div>
        <label for="diastolic">Diastolic Blood Pressure:</label>
        <input type="number" id="diastolic">
    </div>
    <form>
        <label for="history">Choose any of the following that is in the persons family history:</label><br>
        <p>Use shift and then select if you need to select multiple</p>
        <select id="history" name="history" multiple>
            <option value="diabetes">Diabetes</option>
            <option value="cancer">Cancer</option>
            <option value="alzheimers">Alzheimers</option>
        </select><br>
    </form>
    <button type="button" onclick="calculatePoints()"> Submit</button>
    <p id="agePointsResult"></p>
    <p id="bmiPointsResult"></p>
    <script>
        async function calculatePoints() {
    const age = document.getElementById('age').value;
    const height = document.getElementById('height').value;
    const weight = document.getElementById('weight').value;
    const systolic = document.getElementById('systolic').value;
    const diastolic = document.getElementById('diastolic').value;
    const history = Array.from(document.getElementById('history').selectedOptions).map(option => option.value);
    
    await calculateAge(age, height, weight, systolic, diastolic, history);
    await calculateBMI(age, height, weight, systolic, diastolic, history);
}

async function calculateBMI(age, height, weight, systolic, diastolic, history) {
    const response = await fetch('https://health-insurance-node.azurewebsites.net/calculateBMI', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ age, height, weight, systolic, diastolic, history })
    });

    const data = await response.json();
    document.getElementById('bmiPointsResult').innerText = `Body Mass: ${data.bmiPoints} (index = ${data.bmi})`;


}

async function calculateAge(age, height, weight, systolic, diastolic, history) {
    const response = await fetch('https://health-insurance-node.azurewebsites.net/addAge', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ age, height, weight, systolic, diastolic, history })
    });

    const data = await response.json();
    document.getElementById('agePointsResult').innerText = `Age: ${data.agePoints}`;
}


    </script>
</body>
</html>

